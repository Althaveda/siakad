/*SIAKAD UNCP Js Config*/
/*==========================================*/
/*Dev		=> Muhammad Dicky Hidayat Latif*/
/*Email		=> muh.dickyhidayat@gmail.com*/
/*==========================================*/

function chart_pengguna(a,t,e,s){var n=$("#pieChart-data-pengguna").get(0).getContext("2d"),i=new Chart(n),l=[{value:a,color:"#f39c12",highlight:"#f39c12",label:"Pengguna Mahasiswa"},{value:t,color:"#00c0ef",highlight:"#00c0ef",label:"Pengguna Tenaga Pendidik"}],r={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:40,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,responsive:!0,maintainAspectRatio:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>',tooltipTemplate:"<%=label%> : <%=value %> Orang"};i.Doughnut(l,r);var n=$("#pieChart-data-pengguna-status").get(0).getContext("2d"),l=[{value:e,color:"#00a65a",highlight:"#00a65a",label:"Pengguna Aktif"},{value:s,color:"#dd4b39",highlight:"#dd4b39",label:"Pengguna Nonaktif"}],r={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:40,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,responsive:!0,maintainAspectRatio:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>',tooltipTemplate:"<%=label%> : <%=value %> Orang"};(i=new Chart(n)).Doughnut(l,r)}function chart_mhs_pd(a){var t=$("#pieChart-data-mhs").get(0).getContext("2d"),e={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,responsive:!0,maintainAspectRatio:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>',tooltipTemplate:"<%=label%> : <%=value %> Orang"};new Chart(t).Pie(a,e)}function line_chart_mhs_pd(a,t,e,s){var n=$("#barchart-mhs-pd").get(0).getContext("2d"),i=new Chart(n),l={labels:a,datasets:[{label:"Laki-Laki",fillColor:s,strokeColor:s,pointColor:s,pointStrokeColor:"#c1c7d1",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:t},{label:"Perempuan",fillColor:s,strokeColor:s,pointColor:s,pointStrokeColor:"rgba(60,141,188,1)",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(60,141,188,1)",data:e}]},r={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',responsive:!0,maintainAspectRatio:!0,multiTooltipTemplate:"<%= datasetLabel %>: <%= value %> Orang"};r.datasetFill=!1,i.Bar(l,r)}function line_chart_mhs_thn(a,t,e,s){var n=$("#barchart-mhs-thn").get(0).getContext("2d"),i=new Chart(n),l={labels:a,datasets:[{label:"Laki-Laki",fillColor:s,strokeColor:s,pointColor:s,pointStrokeColor:"#c1c7d1",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:t},{label:"Perempuan",fillColor:s,strokeColor:s,pointColor:s,pointStrokeColor:"rgba(60,141,188,1)",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(60,141,188,1)",data:e}]},r={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',responsive:!0,maintainAspectRatio:!0};r.datasetFill=!1,i.Bar(l,r)}function chart_ptk(a){var t=$("#pieChart-data-ptk").get(0).getContext("2d"),e={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,responsive:!0,maintainAspectRatio:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>',tooltipTemplate:"<%=label%> : <%=value %> Orang"};new Chart(t).Pie(a,e)}var path=window.location.pathname,host=window.location.hostname;$(function(){moment.locale("id");var a=getJSON("http://"+host+path+"dashboard/data_statistik/pengguna");$(".grafik-data-pengguna .progress-pengguna-siswa").css("width",a.statik_pengguna_siswa+"%"),$(".grafik-data-pengguna .progress-pengguna-guru").css("width",a.statik_pengguna_guru+"%"),$(".grafik-status-pengguna .progress-pengguna-aktif").css("width",a.statik_pengguna_aktif+"%"),$(".grafik-status-pengguna .progress-pengguna-nonaktif").css("width",a.statik_pengguna_nonaktif+"%"),chart_pengguna(a.count_user_siswa,a.count_user_guru,a.count_user_aktif,a.count_user_nonaktif),$("table.tbl-user-last-online").find("tbody").text(""),$.each(a.record_last_online,function(a,t){if("mhs"==t.level_akses){e="mhs";t.level_akses="Mahasiswa"}else{var e="ptk";t.level_akses="Tenaga Pendidik"}$("table.tbl-user-last-online").find("tbody").append("<tr><td>"+t.username+'</td><td class="text-center">'+t.level_akses+'</td><td class="text-center"><i class="fa fa-clock-o"></i> '+moment(t.last_online).fromNow()+'</td><td class="text-center"><a href="#detail?id_user='+t.id_user_detail+"-"+e+"&level="+t.level_akses+'" class="btn btn-warning btn-sm" style="width:80%"><i class="fa fa-id-card"></i> Detail Pengguna</a></td></tr>')}),$("#refresh-statik-pengguna").on("click",function(a){a.preventDefault();var t=getJSON("http://"+host+path+"dashboard/data_statistik/pengguna");$(".grafik-data-pengguna .progress-pengguna-siswa").css("width","0%"),$(".grafik-data-pengguna .progress-pengguna-guru").css("width","0%"),$(".grafik-status-pengguna .progress-pengguna-aktif").css("width","0%"),$(".grafik-status-pengguna .progress-pengguna-nonaktif").css("width","0%"),$("#pieChart-data-pengguna").replaceWith('<canvas id="pieChart-data-pengguna" height="140"></canvas>'),$("#pieChart-data-pengguna-status").replaceWith('<canvas id="pieChart-data-pengguna-status" height="140"></canvas>'),collapse_box(".box-grafik-pengguna, .grafik-data-pengguna, .grafik-status-pengguna"),$(".box-grafik-pengguna .fa-refresh").addClass("fa-spin"),delay(function(){$(".grafik-data-pengguna .progress-pengguna-siswa").css("width",t.statik_pengguna_siswa+"%"),$(".grafik-data-pengguna .progress-pengguna-guru").css("width",t.statik_pengguna_guru+"%"),$(".grafik-status-pengguna .progress-pengguna-aktif").css("width",t.statik_pengguna_aktif+"%"),$(".grafik-status-pengguna .progress-pengguna-nonaktif").css("width",t.statik_pengguna_nonaktif+"%"),$(".box-grafik-pengguna .fa-refresh").removeClass("fa-spin")},1050),chart_pengguna(t.count_user_siswa,t.count_user_guru,t.count_user_aktif,t.count_user_nonaktif),$("table.tbl-user-last-online").find("tbody").text(""),$.each(t.record_last_online,function(a,t){"mhs"==t.level_akses?t.level_akses="Mahasiswa":t.level_akses="Tenaga Pendidik",$("table.tbl-user-last-online").find("tbody").append("<tr><td>"+t.username+'</td><td class="text-center">'+t.level_akses+'</td><td class="text-center"><i class="fa fa-clock-o"></i> '+moment(t.last_online).fromNow()+'</td><td class="text-center"><a href="#detail?id_user='+t.id_user_detail+"&level="+t.level_akses+'" class="btn btn-warning btn-sm" style="width:80%"><i class="fa fa-id-card"></i> Detail Pengguna</a></td></tr>')})});var t=getJSON("http://"+host+path+"dashboard/data_statistik/pd");chart_mhs_pd(t.canvas),line_chart_mhs_pd(t.nama_prodi,t.mhs_lk,t.mhs_pr,t.color),line_chart_mhs_thn(t.thn_angkatan,t.mhs_lk_thn,t.mhs_pr_thn,t.color_thn),t.pd.length>4?$(".grafik-mhs ul.daftar-pd").css("height","163px"):$(".grafik-mhs ul.daftar-pd").css("height","");var e=1;$(".grafik-mhs ul.daftar-pd, .grafik-mhs ul.daftar-thn, .detail-jml-mhs").text(""),$(".detail-jml-mhs").prepend('<p class="text-center"><strong>Keterangan</strong></p>'),$.each(t.pd,function(a,t){$(".grafik-mhs ul.daftar-pd").append("<li><a>"+t.nama_prodi+" ("+t.jenjang_prodi+')<span class="pull-right badge" style="background-color:'+t.color_detail+'">'+t.statik_mhs+"%</span></a></li>"),$(".detail-jml-mhs").append('<div class="progress-group">  <span class="progress-text"><i class="fa fa-circle" style="color: '+t.color_detail+';"></i> Prodi '+e+": "+t.nama_prodi+" ("+t.jenjang_prodi+')</span>  <span class="progress-number">'+t.statik_mhs+'%</span>  <div class="progress sm">    <div class="progress-bar p-bar-'+e+'" style="background-color:'+t.color_detail+';"></div>  </div></div>'),e++}),e=1,delay(function(){$.each(t.pd,function(a,t){$(".p-bar-"+e).css("width",t.statik_mhs+"%"),e++})},100),$.each(t.thn,function(a,t){$(".grafik-mhs ul.daftar-thn").append("<li><a>Tahun Angkatan "+t.tahun_angkatan+'<span class="pull-right badge" style="background-color:'+t.color_detail+'">'+t.statik_mhs+"%</span></a></li>")}),$("#refresh-statik-mhs").on("click",function(){var a=getJSON("http://"+host+path+"dashboard/data_statistik/pd");collapse_box(".grafik-mhs, .grafik-mhs .box"),$("#pieChart-data-mhs").replaceWith('<canvas id="pieChart-data-mhs" height="250"></canvas>'),$("#barchart-mhs-pd").replaceWith('<canvas id="barchart-mhs-pd" style="height: 330px; width: 510px;"></canvas>'),$("#barchart-mhs-thn").replaceWith('<canvas id="barchart-mhs-thn" height="137"></canvas>'),chart_mhs_pd(a.canvas),line_chart_mhs_pd(a.nama_prodi,a.mhs_lk,a.mhs_pr,a.color),line_chart_mhs_thn(a.thn_angkatan,a.mhs_lk_thn,a.mhs_pr_thn,a.color_thn),$(".grafik-mhs ul.daftar-pd, .grafik-mhs ul.daftar-thn, .detail-jml-mhs").text(""),$(".detail-jml-mhs").prepend('<p class="text-center"><strong>Keterangan</strong></p>'),a.pd.length>4?$(".grafik-mhs ul.daftar-pd").css("height","163px"):$(".grafik-mhs ul.daftar-pd").css("height","");var t=1;$.each(a.pd,function(a,e){$(".grafik-mhs ul.daftar-pd").append("<li><a>"+e.nama_prodi+" ("+e.jenjang_prodi+')<span class="pull-right badge" style="background-color:'+e.color_detail+'">'+e.statik_mhs+"%</span></a></li>"),$(".detail-jml-mhs").append('<div class="progress-group">  <span class="progress-text"><i class="fa fa-circle" style="color: '+e.color_detail+';"></i> Prodi '+t+": "+e.nama_prodi+" ("+e.jenjang_prodi+')</span>  <span class="progress-number">'+e.statik_mhs+'%</span>  <div class="progress sm">    <div class="progress-bar p-bar-'+t+'" style="background-color:'+e.color_detail+';"></div>  </div></div>'),t++}),$.each(a.thn,function(a,t){$(".grafik-mhs ul.daftar-thn").append("<li><a>Tahun Angkatan "+t.tahun_angkatan+'<span class="pull-right badge" style="background-color:'+t.color_detail+'">'+t.statik_mhs+"%</span></a></li>")}),$(".grafik-mhs .fa-refresh").addClass("fa-spin"),t=1,delay(function(){$.each(a.pd,function(a,e){$(".p-bar-"+t).css("width",e.statik_mhs+"%"),t++}),$(".grafik-mhs .fa-refresh").removeClass("fa-spin")},1050)});var s=getJSON("http://"+host+path+"dashboard/data_statistik/ptk");chart_ptk(s.canvas),s.pd.length>10?$(".grafik-ptk ul.daftar-pd").css("height","408px"):$(".grafik-ptk ul.daftar-pd").css("height",""),$(".grafik-ptk ul.daftar-pd").text(""),$.each(s.pd,function(a,t){$(".grafik-ptk ul.daftar-pd").append("<li><a>"+t.nama_prodi+" ("+t.jenjang_prodi+')<span class="pull-right badge" style="background-color:'+t.color_detail+'">'+t.statik_ptk+"%</span></a></li>")}),$("#refresh-statik-ptk").on("click",function(){var a=getJSON("http://"+host+path+"dashboard/data_statistik/ptk");collapse_box(".grafik-ptk"),$(".grafik-ptk .fa-refresh").addClass("fa-spin"),delay(function(){$(".grafik-ptk .fa-refresh").removeClass("fa-spin")},1050),$("#pieChart-data-ptk").replaceWith('<canvas id="pieChart-data-ptk" height="180"></canvas>'),chart_ptk(a.canvas),a.pd.length>10?$(".grafik-ptk ul.daftar-pd").css("height","408px"):$(".grafik-ptk ul.daftar-pd").css("height",""),$(".grafik-ptk ul.daftar-pd").text(""),$.each(a.pd,function(a,t){$(".grafik-ptk ul.daftar-pd").append("<li><a>"+t.nama_prodi+" ("+t.jenjang_prodi+')<span class="pull-right badge" style="background-color:'+t.color_detail+'">'+t.statik_ptk+"%</span></a></li>")})})});