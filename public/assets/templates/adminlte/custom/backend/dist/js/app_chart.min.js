/*SIAKAD UNCP Js Chart Config*/
/*==========================================*/
/*Dev		=> Muhammad Dicky Hidayat Latif*/
/*Email		=> muh.dickyhidayat@gmail.com*/
/*==========================================*/

function data_chart_pengguna(a,t,e,n,i,s){if(1==s&&($(".grafik-data-pengguna .progress-pengguna-siswa").css("width","0%"),$(".grafik-data-pengguna .progress-pengguna-guru").css("width","0%"),$(".grafik-status-pengguna .progress-pengguna-aktif").css("width","0%"),$(".grafik-status-pengguna .progress-pengguna-nonaktif").css("width","0%"),$("#pieChart-data-pengguna").replaceWith('<canvas id="pieChart-data-pengguna" height="140"></canvas>'),$("#pieChart-data-pengguna-status").replaceWith('<canvas id="pieChart-data-pengguna-status" height="140"></canvas>')),"success"==a.status){$(".box-grafik-pengguna .data-container").show(),$(".box-grafik-pengguna .data-empty-container").text("").hide(),1==s?delay(function(){$(".grafik-data-pengguna .progress-pengguna-siswa").css("width",a.statik_pengguna_mhs+"%"),$(".grafik-data-pengguna .progress-pengguna-guru").css("width",a.statik_pengguna_ptk+"%"),$(".grafik-status-pengguna .progress-pengguna-aktif").css("width",a.statik_pengguna_aktif+"%"),$(".grafik-status-pengguna .progress-pengguna-nonaktif").css("width",a.statik_pengguna_nonaktif+"%")},850):($(".grafik-data-pengguna .progress-pengguna-siswa").css("width",a.statik_pengguna_mhs+"%"),$(".grafik-data-pengguna .progress-pengguna-guru").css("width",a.statik_pengguna_ptk+"%"),$(".grafik-status-pengguna .progress-pengguna-aktif").css("width",a.statik_pengguna_aktif+"%"),$(".grafik-status-pengguna .progress-pengguna-nonaktif").css("width",a.statik_pengguna_nonaktif+"%")),$("table.tbl-user-last-online").find("tbody").text(""),$.each(a.record_last_online,function(a,t){if("mhs"==t.level_akses)e="Mahasiswa";else var e="Tenaga Pendidik";$("table.tbl-user-last-online").find("tbody").append("<tr><td>"+t.username+'</td><td class="text-center">'+e+'</td><td class="text-center"><i class="fa fa-clock-o"></i> '+moment(t.last_online).fromNow()+'</td><td class="text-center"><a href="#detail?id_user='+t.id_user_detail+"-"+t.level_akses+"&level="+e.replace(" ","_").toLowerCase()+'" class="btn btn-warning btn-sm" style="width:80%"><i class="fa fa-id-card"></i> Detail Pengguna</a></td></tr>')});var o=$("#pieChart-data-pengguna").get(0).getContext("2d"),l=new Chart(o),r=[{value:t,color:"#f39c12",highlight:"#f39c12",label:"Pengguna Mahasiswa"},{value:e,color:"#00c0ef",highlight:"#00c0ef",label:"Pengguna Tenaga Pendidik"}],g={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:40,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,responsive:!0,maintainAspectRatio:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>',tooltipTemplate:"<%=label%> : <%=value %> Orang"};l.Doughnut(r,g);var o=$("#pieChart-data-pengguna-status").get(0).getContext("2d"),r=[{value:n,color:"#00a65a",highlight:"#00a65a",label:"Pengguna Aktif"},{value:i,color:"#dd4b39",highlight:"#dd4b39",label:"Pengguna Nonaktif"}],g={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:40,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,responsive:!0,maintainAspectRatio:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>',tooltipTemplate:"<%=label%> : <%=value %> Orang"};(l=new Chart(o)).Doughnut(r,g)}else $(".box-grafik-pengguna .data-container").hide(),$(".box-grafik-pengguna .data-empty-container").html('<p class="text-center">Untuk saat ini sistem belum memiliki data pengguna</p>').show()}function data_chart_mhs_pd(a,t,e){var n=100;if(1==e&&($("#pieChart-data-mhs").replaceWith('<canvas id="pieChart-data-mhs" height="250"></canvas>'),$("#barchart-mhs-pd").replaceWith('<canvas id="barchart-mhs-pd" style="height: 330px; width: 510px;"></canvas>'),$("#barchart-mhs-thn").replaceWith('<canvas id="barchart-mhs-thn" height="137"></canvas>'),n=850),"success"==a.status){$(".grafik-mhs .data-container, .grafik-mhs .box-footer").show(),$(".grafik-mhs .data-empty-container").text("").hide(),a.pd.length>4?$(".grafik-mhs .daftar-pd").slimScroll({position:"right",height:"163px",allowPageScroll:!0}):$(".grafik-mhs .daftar-pd").slimScroll({position:"right",height:"",allowPageScroll:!0}),$(".grafik-mhs ul.daftar-pd, .grafik-mhs ul.daftar-thn, .detail-jml-mhs").text(""),$(".detail-jml-mhs").prepend('<p class="text-center"><strong>Keterangan</strong></p>'),line_chart_mhs_pd(a.nama_prodi,a.mhs_lk,a.mhs_pr,a.color),line_chart_mhs_thn(a.thn_angkatan,a.mhs_lk_thn,a.mhs_pr_thn,a.color_thn);var i=1;$.each(a.pd,function(a,t){$(".grafik-mhs ul.daftar-pd").append("<li><a>"+t.nama_prodi+" ("+t.jenjang_prodi+')<span class="pull-right badge" style="background-color:'+t.color_detail+'">'+t.statik_mhs+"%</span></a></li>"),$(".detail-jml-mhs").append('<div class="progress-group">  <span class="progress-text"><i class="fa fa-circle" style="color: '+t.color_detail+';"></i> Prodi '+i+": "+t.nama_prodi+" ("+t.jenjang_prodi+')</span>  <span class="progress-number">'+t.statik_mhs+'%</span>  <div class="progress sm">    <div class="progress-bar p-bar-'+i+'" style="background-color:'+t.color_detail+';"></div>  </div></div>'),i++}),i=1,delay(function(){$.each(a.pd,function(a,t){$(".p-bar-"+i).css("width",t.statik_mhs+"%"),i++})},n),$.each(a.thn,function(a,t){$(".grafik-mhs ul.daftar-thn").append("<li><a>Tahun Angkatan "+t.tahun_angkatan+'<span class="pull-right badge" style="background-color:'+t.color_detail+'">'+t.statik_mhs+"%</span></a></li>")});var s=$("#pieChart-data-mhs").get(0).getContext("2d"),o={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,responsive:!0,maintainAspectRatio:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>',tooltipTemplate:"<%=label%> : <%=value %> Orang"};new Chart(s).Pie(t,o)}else $(".grafik-mhs .data-container, .grafik-mhs .box-footer").hide(),$(".grafik-mhs .data-empty-container").html('<p class="text-center">Untuk saat ini sistem belum memiliki data mahasiswa</p>').show()}function line_chart_mhs_pd(a,t,e,n){var i=$("#barchart-mhs-pd").get(0).getContext("2d"),s=new Chart(i),o={labels:a,datasets:[{label:"Laki-Laki",fillColor:n,strokeColor:n,pointColor:n,pointStrokeColor:"#c1c7d1",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:t},{label:"Perempuan",fillColor:n,strokeColor:n,pointColor:n,pointStrokeColor:"rgba(60,141,188,1)",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(60,141,188,1)",data:e}]},l={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',responsive:!0,maintainAspectRatio:!0,multiTooltipTemplate:"<%= datasetLabel %>: <%= value %> Orang"};l.datasetFill=!1,s.Bar(o,l)}function line_chart_mhs_thn(a,t,e,n){var i=$("#barchart-mhs-thn").get(0).getContext("2d"),s=new Chart(i),o={labels:a,datasets:[{label:"Laki-Laki",fillColor:n,strokeColor:n,pointColor:n,pointStrokeColor:"#c1c7d1",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:t},{label:"Perempuan",fillColor:n,strokeColor:n,pointColor:n,pointStrokeColor:"rgba(60,141,188,1)",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(60,141,188,1)",data:e}]},l={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',responsive:!0,maintainAspectRatio:!0,multiTooltipTemplate:"<%= datasetLabel %>: <%= value %> Orang"};l.datasetFill=!1,s.Bar(o,l)}function data_chart_ptk(a,t,e){if("success"==a.status){$("#pieChart-data-ptk").replaceWith('<canvas id="pieChart-data-ptk" height="180"></canvas>'),$(".grafik-ptk .data-container, .grafik-ptk .box-footer").show(),$(".grafik-ptk .data-empty-container").text("").hide(),a.pd.length>10?$(".grafik-ptk ul.daftar-pd").slimScroll({position:"right",height:"423px",allowPageScroll:!0}):$(".grafik-ptk ul.daftar-pd").slimScroll({position:"right",height:"",allowPageScroll:!0}),$(".grafik-ptk ul.daftar-pd").text(""),$.each(a.pd,function(a,t){$(".grafik-ptk ul.daftar-pd").append("<li><a>"+t.nama_prodi+" ("+t.jenjang_prodi+')<span class="pull-right badge" style="background-color:'+t.color_detail+'">'+t.statik_ptk+"%</span></a></li>")});var n=$("#pieChart-data-ptk").get(0).getContext("2d"),i={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,responsive:!0,maintainAspectRatio:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>',tooltipTemplate:"<%=label%> : <%=value %> Orang"};new Chart(n).Pie(t,i)}else $(".grafik-ptk .data-container, .grafik-ptk .box-footer").hide(),$(".grafik-ptk .data-empty-container").html('<p class="text-center">Untuk saat ini sistem belum memiliki data tenaga pendidik</p>').show()}var path=window.location.pathname,host=window.location.hostname;$(document).ready(function(){$(".detail-jml-mhs").slimScroll({position:"right",height:"385px",allowPageScroll:!0}),moment.locale("id"),Pace.once("done",function(){setTimeout(function(){$(".grafik-mhs").find("div.overlay").fadeIn(),getJSON_async("http://"+host+path+"/dashboard/data_statistik/pd",null,1).then(function(a){$(".grafik-mhs").find("div.overlay").fadeOut(),data_chart_mhs_pd(a,a.canvas)}).catch(function(a){collapse_toggle(".grafik-mhs"),$(".grafik-mhs").find("div.overlay").fadeOut()}),$(".box-grafik-pengguna").find("div.overlay").fadeIn(),getJSON_async("http://"+host+path+"/dashboard/data_statistik/pengguna").then(function(a){$(".box-grafik-pengguna").find("div.overlay").fadeOut(),data_chart_pengguna(a,a.count_user_mhs,a.count_user_ptk,a.count_user_aktif,a.count_user_nonaktif,!1)}).catch(function(a){collapse_toggle(".box-grafik-pengguna"),$(".box-grafik-pengguna").find("div.overlay").fadeOut()}),getJSON_async("http://"+host+path+"/dashboard/data_statistik/ptk").then(function(a){data_chart_ptk(a,a.canvas)}).catch(function(a){collapse_toggle(".grafik-ptk")})},200)}),$("#refresh-statik-pengguna").on("click",function(a){a.preventDefault();var t=$(this).find("i");t.addClass("fa-spin"),setTimeout(function(){t.removeClass("fa-spin")},1070),$(".box-grafik-pengguna").find("div.overlay").fadeIn(),collapse_box(".box-grafik-pengguna, .grafik-data-pengguna, .grafik-status-pengguna"),getJSON_async("http://"+host+path+"/dashboard/data_statistik/pengguna",null,null,!0).then(function(a){$(".box-grafik-pengguna").find("div.overlay").fadeOut(),data_chart_pengguna(a,a.count_user_mhs,a.count_user_ptk,a.count_user_aktif,a.count_user_nonaktif,!0)}).catch(function(a){$(".box-grafik-pengguna").find("div.overlay").fadeOut()})}),$("#refresh-statik-mhs").on("click",function(){var a=$(this).find("i");a.addClass("fa-spin"),setTimeout(function(){a.removeClass("fa-spin")},1070),$(".grafik-mhs").find("div.overlay").fadeIn(),collapse_box(".grafik-mhs, .grafik-mhs .box"),getJSON_async("http://"+host+path+"/dashboard/data_statistik/pd",null,null,!0).then(function(a){$(".detail-jml-mhs .progress-bar").css("width","0%"),$(".detail-jml-mhs .progress-number").text("0%"),$(".grafik-mhs").find("div.overlay").fadeOut(),setTimeout(function(){data_chart_mhs_pd(a,a.canvas,!0)},500)}).catch(function(a){$(".grafik-mhs").find("div.overlay").fadeOut()})}),$("#refresh-statik-ptk").on("click",function(){var a=$(this).find("i");a.addClass("fa-spin"),setTimeout(function(){a.removeClass("fa-spin")},1070),collapse_box(".grafik-ptk"),getJSON_async("http://"+host+path+"/dashboard/data_statistik/ptk",null,null,!0).then(function(a){data_chart_ptk(a,a.canvas,!0)}).catch(function(a){})})});